import{u as Y,r,j as e,H as Z,a as h,t as l}from"./app-CWQYjesW.js";import{P as ee}from"./Index-FgTW9mE0.js";import{A as _,a as O,b as T,c as q,d as y,e as E,f as B,g as F}from"./alert-dialog-DhUswqu4.js";import{B as g}from"./badge-C9TpCT63.js";import{B as i}from"./button-Dif-jUvB.js";import{D as se,a as te,b as re,c as ae,e as ne,d as k}from"./dropdown-menu-B2Cjc48K.js";import{T as oe,a as le,b as f,c as a,d as ie,e as t}from"./table-Dv4XCUC3.js";import{A as ce}from"./app-layout-CaRbv66n.js";import{T as v}from"./index-CnTLoYi9.js";import{E as de}from"./ellipsis-CWAs5Cu-.js";import{C as pe}from"./circle-check-big-BRZfURik.js";import{C as me}from"./circle-x-B4aYzdh1.js";/* empty css            */import"./select-D88Byryw.js";import"./index-Dc_FVRD7.js";import"./index-HsrAfS9P.js";import"./index-DensfDaT.js";import"./createLucideIcon-DYlXr946.js";import"./index-BQ3Tdzwx.js";import"./index-p0rgwcIB.js";import"./index-xVn67iIP.js";import"./utils-BkIxhzDH.js";import"./check-BkTEbtPm.js";import"./index-BMonI4iZ.js";import"./index-CykbKIKJ.js";import"./proxy-BQoEUct6.js";import"./input-oxdypoZS.js";function Le({withdrawals:c,filters:C}){const M=s=>v("employee.withdrawals.approve",{transaction:s}),P=s=>v("employee.withdrawals.reject",{transaction:s}),{data:n,setData:A}=Y({status:C.status||"pending",per_page:Number(C.per_page||15)}),D=s=>{h.get(v("employee.withdrawals.index"),{...n,...s},{preserveScroll:!0,preserveState:!0})},d=s=>{A("status",s),D({status:s})},H=s=>{A("per_page",s),D({per_page:s})},[I,p]=r.useState(null),[L,m]=r.useState(!1),[$,u]=r.useState(!1),[x,w]=r.useState(null),[j,z]=r.useState(null),N=r.useRef(null),b=r.useRef(null),V=s=>{p(null),document.activeElement?.blur?.(),requestAnimationFrame(()=>{w(s),m(!0)})},X=s=>{p(null),document.activeElement?.blur?.(),requestAnimationFrame(()=>{z(s),u(!0)})},G=()=>{x&&h.post(M(x.id),{},{preserveScroll:!0,onSuccess:()=>l.success("Saque aprovado com sucesso!"),onError:()=>l.error("Erro ao aprovar saque. Tente novamente."),onFinish:()=>m(!1)})},J=()=>{j&&h.post(P(j.id),{},{preserveScroll:!0,onSuccess:()=>l.success("Saque rejeitado com sucesso!"),onError:()=>l.error("Erro ao rejeitar saque. Tente novamente."),onFinish:()=>u(!1)})},S=s=>`R$ ${Number(s??0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,K=s=>s?new Date(s).toLocaleDateString("pt-BR"):"—",Q=s=>s==="approved"?e.jsx(g,{children:"aprovado"}):s==="pending"?e.jsx(g,{variant:"secondary",children:"pendente"}):e.jsx(g,{variant:"destructive",children:"rejeitado"}),U=c?.data?.length>0;return e.jsxs(ce,{children:[e.jsx(Z,{title:"Solicitações de saque"}),e.jsxs("div",{className:"rounded-xl bg-accent px-3 pt-4",children:[e.jsx("div",{className:"flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-center",children:e.jsx("h1",{className:"text-lg font-bold",children:"Solicitações de saque"})}),e.jsxs("div",{className:"mt-4 mb-3 flex items-center gap-2",children:[e.jsx(i,{size:"sm",variant:n.status==="pending"?"default":"outline",onClick:()=>d("pending"),children:"Pendentes"}),e.jsx(i,{size:"sm",variant:n.status==="approved"?"default":"outline",onClick:()=>d("approved"),children:"Aprovados"}),e.jsx(i,{size:"sm",variant:n.status==="rejected"?"default":"outline",onClick:()=>d("rejected"),children:"Rejeitados"})]}),e.jsx("div",{className:"mb-4 rounded-lg",children:e.jsxs(oe,{children:[e.jsx(le,{children:e.jsxs(f,{children:[e.jsx(a,{children:"ID"}),e.jsx(a,{children:"Cliente"}),e.jsx(a,{children:"Plano"}),e.jsx(a,{children:"Data"}),e.jsx(a,{className:"text-right",children:"Valor"}),e.jsx(a,{children:"Status"}),e.jsx(a,{className:"text-right",children:e.jsx("span",{className:"sr-only",children:"Ações"})})]})}),e.jsx(ie,{children:U?c.data.map(s=>{const R=`${s.customer_plan?.customer?.name??"Cliente"} — ${S(s.amount)}`,W=I===s.id;return e.jsxs(f,{className:"hover:!bg-secondary/10",children:[e.jsx(t,{children:s.id}),e.jsxs(t,{className:"max-w-48 truncate",children:[s.customer_plan?.customer?.name??"—",s.customer_plan?.customer?.email&&e.jsx("div",{className:"text-xs text-muted-foreground",children:s.customer_plan.customer.email})]}),e.jsx(t,{className:"max-w-48 truncate",children:s.customer_plan?.plan?.name??"—"}),e.jsx(t,{children:K(s.created_at||s.effective_date)}),e.jsx(t,{className:"text-right",children:S(s.amount)}),e.jsx(t,{children:Q(s.status)}),e.jsx(t,{className:"text-right",children:s.status==="pending"?e.jsxs(se,{open:W,onOpenChange:o=>p(o?s.id:null),children:[e.jsx(te,{asChild:!0,children:e.jsxs(i,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Abrir menu"}),e.jsx(de,{className:"h-4 w-4"})]})}),e.jsxs(re,{align:"end",children:[e.jsx(ae,{children:"Ações"}),e.jsx(ne,{}),e.jsxs(k,{onSelect:o=>{o.preventDefault(),V({id:s.id,label:R})},children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Aprovar"]}),e.jsxs(k,{className:"text-red-600 focus:text-red-600",onSelect:o=>{o.preventDefault(),X({id:s.id,label:R})},children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Rejeitar"]})]})]}):e.jsx("span",{className:"text-muted-foreground",children:"—"})})]},s.id)}):e.jsx(f,{children:e.jsx(t,{colSpan:7,className:"h-24 text-center text-sm text-muted-foreground",children:"Nada encontrado."})})})]})}),e.jsx("div",{className:"mt-3",children:e.jsx(ee,{meta:c.meta??{total:0,per_page:15,current_page:1,last_page:1,links:[],path:"",from:null,to:null},perPage:n.per_page,setPerPage:H})})]}),e.jsx(_,{open:L,onOpenChange:m,children:e.jsxs(O,{onOpenAutoFocus:s=>{s.preventDefault(),N.current?.focus()},children:[e.jsxs(T,{children:[e.jsx(q,{children:"Aprovar saque?"}),e.jsx(y,{children:x?.label})]}),e.jsxs(E,{children:[e.jsx(B,{ref:N,children:"Cancelar"}),e.jsx(F,{onClick:G,children:"Aprovar"})]})]})}),e.jsx(_,{open:$,onOpenChange:u,children:e.jsxs(O,{onOpenAutoFocus:s=>{s.preventDefault(),b.current?.focus()},children:[e.jsxs(T,{children:[e.jsx(q,{children:"Rejeitar saque?"}),e.jsx(y,{children:j?.label})]}),e.jsxs(E,{children:[e.jsx(B,{ref:b,children:"Cancelar"}),e.jsx(F,{className:"bg-red-600 hover:bg-red-700",onClick:J,children:"Rejeitar"})]})]})})]})}export{Le as default};
