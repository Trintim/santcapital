import{u as y,r as S,j as e,H as N,t as c}from"./app-CWQYjesW.js";import{P as T}from"./PercentInput-Cdtg2D8p.js";import{I as P}from"./input-error-BD4lUoz8.js";import{B as p}from"./button-Dif-jUvB.js";import{C as w,a as A,b as u,d as E}from"./card-C5BbfPUs.js";import{L as t}from"./label-DTM-FZR3.js";import{S as F,a as H,b as R,c as I,d as Y}from"./select-D88Byryw.js";import{T as z,a as B,b as x,c as n,d as D,e as o}from"./table-Dv4XCUC3.js";import{A as L}from"./app-layout-CaRbv66n.js";/* empty css            */import"./input-oxdypoZS.js";import"./utils-BkIxhzDH.js";import"./createLucideIcon-DYlXr946.js";import"./index-BQ3Tdzwx.js";import"./index-Dc_FVRD7.js";import"./index-HsrAfS9P.js";import"./index-DensfDaT.js";import"./index-p0rgwcIB.js";import"./index-xVn67iIP.js";import"./check-BkTEbtPm.js";import"./proxy-BQoEUct6.js";import"./index-BMonI4iZ.js";import"./index-CykbKIKJ.js";import"./dropdown-menu-B2Cjc48K.js";function me({customerPlans:d,userId:h}){const{data:s,setData:l,post:_,errors:j}=y({period:"",custom_yields:[],recorded_by:h}),[r,i]=S.useState({customer_plan_id:"",percent_decimal:""});function f(a){l(a.target.name,a.target.value)}function b(){r.customer_plan_id&&r.percent_decimal&&(l("custom_yields",[...s.custom_yields,{customer_plan_id:Number(r.customer_plan_id),percent_decimal:r.percent_decimal}]),i({customer_plan_id:"",percent_decimal:""}))}function C(a){a.preventDefault(),_("/admin/rendimentos-semanais",{onSuccess:()=>c.success("Rendimento registrado com sucesso."),onError:()=>c.error("Erro ao registrar rendimento. Verifique os campos e tente novamente.")})}return e.jsxs(L,{children:[e.jsx(N,{title:"Cadastrar rendimento semanal personalizado"}),e.jsx("div",{className:"mx-auto max-w-xl py-8",children:e.jsxs(w,{children:[e.jsxs(A,{children:[e.jsx(u,{children:"Cadastro de rendimento semanal personalizado"}),e.jsx(E,{children:"Adicione rendimentos manuais para clientes em seus planos ativos. O rendimento padrão do plano será aplicado automaticamente para os demais."})]}),e.jsxs("form",{onSubmit:C,className:"space-y-6 px-6 pb-6",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"period",children:"Período (início da semana)"}),e.jsx("input",{type:"date",name:"period",id:"period",value:s.period,onChange:f,required:!0,className:"w-full rounded border px-3 py-2"}),e.jsx(P,{message:j.period})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx(u,{className:"mb-2 text-base",children:"Rendimentos personalizados para clientes"}),e.jsxs("div",{className:"mb-2 flex items-end gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(t,{htmlFor:"customer_plan_id",children:"Cliente/Plano"}),e.jsxs(F,{value:r.customer_plan_id,onValueChange:a=>i({...r,customer_plan_id:a}),children:[e.jsx(H,{id:"customer_plan_id",children:e.jsx(R,{placeholder:"Selecione o cliente/plano"})}),e.jsx(I,{children:d.map(a=>e.jsxs(Y,{value:String(a.id),children:[a.customer_name," - ",a.plan_name]},a.id))})]})]}),e.jsxs("div",{className:"w-32",children:[e.jsx(t,{htmlFor:"custom_percent",children:"Percentual"}),e.jsx(T,{value:r.percent_decimal,onChange:a=>i({...r,percent_decimal:a}),placeholder:"0,00"})]}),e.jsx(p,{type:"button",variant:"secondary",onClick:b,children:"Adicionar"})]}),e.jsxs(z,{children:[e.jsx(B,{children:e.jsxs(x,{children:[e.jsx(n,{children:"Cliente"}),e.jsx(n,{children:"Plano"}),e.jsx(n,{children:"Percentual"})]})}),e.jsx(D,{children:s.custom_yields.map((a,v)=>{const m=d.find(g=>g.id===a.customer_plan_id);return e.jsxs(x,{children:[e.jsx(o,{children:m?.customer_name??a.customer_plan_id}),e.jsx(o,{children:m?.plan_name??"-"}),e.jsxs(o,{children:[a.percent_decimal,"%"]})]},v)})})]})]}),e.jsx(p,{type:"submit",className:"mt-6 w-full",children:"Registrar rendimentos"})]})]})})]})}export{me as default};
