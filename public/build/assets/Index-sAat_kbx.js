import{u as L,r,j as e,H as E,L as b,a as v,t as l}from"./app-BTymDE-b.js";import{P as z}from"./Index-BJE5hFwe.js";import{A as B,a as H,b as I,c as J,e as O,f as $,g as q}from"./alert-dialog-DiBo0ReV.js";import{B as M}from"./badge-FDCXrNx6.js";import{B as c}from"./button-0cFyQk5l.js";import{C as W,a as G,b as K,d as Q,c as U}from"./card-DgBBEt0T.js";import{I as V}from"./input-CeqObPA2.js";import{T as X,a as Z,b as C,c as n,d as Y,e as o}from"./table-DufyZNTU.js";import{A as ee,T as y,a as T,b as w}from"./app-layout-Ctney_0w.js";import{T as s}from"./index-CnTLoYi9.js";import{S as ae}from"./search-CIJ9iWFu.js";import{c as se}from"./createLucideIcon-CdDXl1n5.js";import{T as re}from"./trash-2-Bf6h3e5I.js";/* empty css            */import"./select-CXekZFRK.js";import"./index-Dc_FVRD7.js";import"./index-C9ZXAN1u.js";import"./index-CcDKZjMs.js";import"./index-C1SMWg6O.js";import"./index-DOyuSIH3.js";import"./index-BjsA19nC.js";import"./utils-BkIxhzDH.js";import"./check-CpxbXbUo.js";import"./dropdown-menu-8hpJ0En7.js";import"./index-85cLjII4.js";import"./index-B3n4jYYB.js";import"./proxy-BMoTdZYb.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],oe=se("Pen",ne);function Fe({customYields:d,filters:t}){const{data:i,setData:u}=L({search:t?.search||"","per-page":t?.["per-page"]||15,"sort-by":t?.["sort-by"]||"period",direction:t?.direction||"desc"}),[D,A]=r.useState(i["per-page"]),[S,m]=r.useState(!1),[p,N]=r.useState(null),[x,j]=r.useState(!1),f=r.useRef(null),g=d.data.length>0,_=a=>{A(a),u(h=>({...h,"per-page":a})),window.location.href=s("admin.weekly-yields.index",{...i,"per-page":a})},k=a=>{u(h=>({...h,search:a.target.value})),window.location.href=s("admin.weekly-yields.index",{...i,search:a.target.value})},P=a=>{N({id:a.id,label:`${a.customer_plan?.customer?.name??a.customer_plan_id} — ${a.period}`}),requestAnimationFrame(()=>m(!0))},R=()=>{p&&v.delete(s("admin.weekly-yields.delete",{id:p.id}),{preserveState:!0,onSuccess:()=>l.success("Rendimento removido com sucesso."),onError:()=>l.error("Erro ao remover rendimento. Tente novamente."),onFinish:()=>m(!1)})},F=()=>{j(!0),v.post(s("admin.weekly-yields.run-job"),{},{preserveState:!0,onSuccess:()=>{l.success("Job semanal disparado com sucesso!"),window.location.reload()},onError:()=>l.error("Erro ao executar job semanal."),onFinish:()=>j(!1)})};return e.jsxs(ee,{children:[e.jsx(E,{title:"Rendimentos Semanais"}),e.jsxs(W,{className:"bg-accent",children:[e.jsxs(G,{children:[e.jsx(K,{children:"Lista de rendimentos semanais"}),e.jsx(Q,{children:"Rendimentos aplicados manualmente para clientes em seus planos, por semana."})]}),e.jsxs(U,{children:[" ",e.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[e.jsx(V,{leftIcon:e.jsx(ae,{className:"size-4"}),name:"search",placeholder:"Buscar cliente...",id:"search",value:i.search,onChange:k,className:"w-full sm:max-w-sm"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{href:s("admin.weekly-yields.create"),children:[" ",e.jsx(c,{children:"Cadastrar rendimento"})," "]}),e.jsx(c,{variant:"outline",disabled:x,onClick:F,children:x?"Executando...":"Testar Job Semanal"})]})]}),g?e.jsxs(X,{children:[e.jsx(Z,{children:e.jsxs(C,{children:[e.jsx(n,{children:"Cliente"}),e.jsx(n,{children:"Plano"}),e.jsx(n,{children:"Período"}),e.jsx(n,{children:"Percentual"}),e.jsx(n,{children:"Ações"})]})}),e.jsx(Y,{children:d.data.map(a=>e.jsxs(C,{children:[e.jsx(o,{children:a.customer_plan?.customer?.name??a.customer_plan_id}),e.jsx(o,{children:a.customer_plan?.plan?.name??"-"}),e.jsx(o,{children:a.period}),e.jsx(o,{children:e.jsxs(M,{variant:parseFloat(a.percent_decimal)>=0?"default":"destructive",children:[parseFloat(a.percent_decimal).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}),"%"]})}),e.jsxs(o,{children:[e.jsxs(y,{children:[e.jsx(T,{asChild:!0,children:e.jsx(b,{href:s("admin.weekly-yields.edit",{id:a.id}),children:e.jsx(c,{variant:"outline",size:"icon",className:"mr-1",children:e.jsx(oe,{className:"size-4"})})})}),e.jsx(w,{children:"Editar"})]}),e.jsxs(y,{children:[e.jsx(T,{asChild:!0,children:e.jsx(c,{variant:"destructive",size:"icon",onClick:()=>P(a),children:e.jsx(re,{className:"size-4"})})}),e.jsx(w,{children:"Remover"})]})]})]},a.id))})]}):e.jsx("div",{className:"py-12 text-center text-muted-foreground",children:"Nenhum rendimento personalizado cadastrado."}),g&&e.jsx(z,{meta:d.meta,perPage:D,setPerPage:_})]})]}),e.jsx(B,{open:S,onOpenChange:m,children:e.jsxs(H,{onOpenAutoFocus:a=>{a.preventDefault(),f.current?.focus()},children:[e.jsx(I,{children:e.jsx(J,{children:"Remover rendimento?"})}),e.jsx("div",{className:"mb-2",children:p?.label}),e.jsxs(O,{children:[e.jsx($,{ref:f,children:"Cancelar"}),e.jsx(q,{className:"bg-red-600 hover:bg-red-700",onClick:R,children:"Remover"})]})]})})]})}export{Fe as default};
