import{u as k,r as c,j as e,a as l,t as u}from"./app-BTymDE-b.js";import{P as H}from"./Index-BJE5hFwe.js";import{A as _,a as q,b as L,c as J,d as Q,e as X,f as G,g as K}from"./alert-dialog-DiBo0ReV.js";import{B as U}from"./badge-FDCXrNx6.js";import{B as A}from"./button-0cFyQk5l.js";import{D as V,a as W,b as Y,c as Z,d as v}from"./dropdown-menu-8hpJ0En7.js";import{I as $}from"./input-CeqObPA2.js";import{T as ee,a as se,b as D,c as n,d as re,e as t}from"./table-DufyZNTU.js";import{u as te,a as ae,P as ne}from"./useSort-DTQgZe5x.js";import{f as oe,a as le}from"./utils-BkIxhzDH.js";import{f as E}from"./index-9YGKT2P1.js";import{T as o}from"./index-CnTLoYi9.js";import{S as ie}from"./search-CIJ9iWFu.js";import{C as P}from"./circle-check-CdrYDRfg.js";import{C as T}from"./circle-x-AcOgvAiC.js";import{E as ce}from"./ellipsis-ChGD3H5v.js";import{P as me}from"./pencil-BFi90FPN.js";import{T as de}from"./trash-2-Bf6h3e5I.js";/* empty css            */import"./select-CXekZFRK.js";import"./index-Dc_FVRD7.js";import"./index-C9ZXAN1u.js";import"./index-CcDKZjMs.js";import"./createLucideIcon-CdDXl1n5.js";import"./index-C1SMWg6O.js";import"./index-DOyuSIH3.js";import"./index-BjsA19nC.js";import"./check-CpxbXbUo.js";import"./index-B3n4jYYB.js";import"./index-85cLjII4.js";import"./proxy-BMoTdZYb.js";function Je({pagination:x,filters:m}){const{data:i,setData:N}=k({search:m.search||"","per-page":m["per-page"]||15}),{handleDebounceFilter:F}=te({path:o("admin.customers.index"),initialData:i,onDataChange:N}),{handleSort:y,getSortDirection:b}=ae({sortBy:m["sort-by"]||"name",sortDirection:m.direction||"asc"}),B=s=>{const r={...i,"per-page":s};N(r),l.get(o("admin.customers.index"),E(r),{preserveState:!0,preserveScroll:!0})},S=s=>{const r=y(s),g={...i,...r};l.get(o("admin.customers.index"),E(g),{preserveState:!0,preserveScroll:!0})},O=x.data.length>0,[I,d]=c.useState(null),[M,h]=c.useState(!1),[p,C]=c.useState(!1),[j,f]=c.useState(null),w=c.useRef(null),z=(s,r)=>{d(null),document.activeElement?.blur?.(),requestAnimationFrame(()=>{f({id:s,name:r}),h(!0)})},R=()=>{j&&(C(!0),l.delete(o("admin.customers.destroy",{customer:j.id}),{preserveScroll:!0,onSuccess:()=>{u.success("Cliente excluído com sucesso.")},onError:()=>{u.error("Erro ao excluir cliente.")},onFinish:()=>{C(!1),h(!1),f(null)}}))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-xl bg-accent px-3 pt-4",children:[e.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-center",children:[e.jsx("h1",{className:"text-lg font-bold",children:"Clientes"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{leftIcon:e.jsx(ie,{className:"size-4"}),name:"search",placeholder:"Buscar clientes...",id:"search",value:i.search,onChange:F,className:"w-full sm:max-w-sm"}),e.jsxs(A,{type:"button",size:"sm",className:"cursor-pointer",onClick:()=>l.visit(o("admin.customers.create")),children:[e.jsx("span",{className:"text-xs",children:"Novo Cliente"}),e.jsx(ne,{className:"size-4"})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"overflow-hidden",children:e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(D,{children:[e.jsx(n,{children:"ID"}),e.jsx(n,{sortable:!0,sortBy:"name",sortDirection:b("name"),onSort:S,children:"Nome"}),e.jsx(n,{sortable:!0,sortBy:"email",sortDirection:b("email"),onSort:S,children:"Email"}),e.jsx(n,{children:"Telefone"}),e.jsx(n,{children:"CPF/CNPJ"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:e.jsx("span",{className:"sr-only",children:"Ações"})})]})}),e.jsx(re,{children:O?x.data.map((s,r)=>{const g=I===s.id;return e.jsxs(D,{className:"hover:!bg-secondary/10",children:[e.jsx(t,{children:r+1}),e.jsx(t,{className:"max-w-32 truncate",children:s.name}),e.jsx(t,{className:"max-w-36 truncate",children:s.email}),e.jsx(t,{children:oe(s.phone||"")}),e.jsx(t,{children:le(s.document||"")}),e.jsx(t,{children:e.jsx(U,{variant:"default",className:s.is_active?"bg-emerald-600 hover:bg-emerald-600":"bg-red-600 hover:bg-red-600",children:s.is_active?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"size-4"}),"Ativo"]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"size-4"}),"Inativo"]})})}),e.jsx(t,{className:"text-right",children:e.jsxs(V,{open:g,onOpenChange:a=>d(a?s.id:null),children:[e.jsx(W,{asChild:!0,children:e.jsx(A,{variant:"ghost",className:"h-8 w-8 p-0","aria-label":"Abrir menu",children:e.jsx(ce,{className:"h-4 w-4"})})}),e.jsxs(Y,{align:"end",children:[e.jsx(Z,{children:"Ações"}),e.jsx(v,{onSelect:a=>{a.preventDefault(),d(null),document.activeElement?.blur?.(),l.patch(o("admin.customers.toggle-active",{customer:s.id}),{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{u.success("Status do cliente alterado com sucesso.")},onError:()=>{u.error("Erro ao alterar status do cliente.")}})},children:s.is_active?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"mr-2 h-4 w-4 text-red-600"}),"Desativar"]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"mr-2 h-4 w-4 text-emerald-600"}),"Ativar"]})}),e.jsxs(v,{onSelect:a=>{a.preventDefault(),d(null),document.activeElement?.blur?.(),l.visit(o("admin.customers.edit",{customer:s.id}))},children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Editar"]}),e.jsxs(v,{className:"text-destructive focus:text-destructive",onSelect:a=>{a.preventDefault(),z(s.id,s.name)},children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Excluir"]})]})]})})]},String(s.id))}):e.jsx(D,{children:e.jsx(t,{colSpan:7,className:"h-24 text-center text-sm text-muted-foreground",children:"Nenhum cliente encontrado."})})})]})})}),e.jsx(H,{meta:x?.meta,perPage:i["per-page"],setPerPage:B})]}),e.jsx(_,{open:M,onOpenChange:s=>{h(s),s||f(null)},children:e.jsxs(q,{onOpenAutoFocus:s=>{s.preventDefault(),w.current?.focus()},children:[e.jsxs(L,{children:[e.jsx(J,{children:"Excluir cliente?"}),e.jsxs(Q,{children:["Esta ação não pode ser desfeita. O cliente ",e.jsx("span",{className:"font-medium",children:j?.name})," será removido permanentemente."]})]}),e.jsxs(X,{children:[e.jsx(G,{ref:w,disabled:p,children:"Cancelar"}),e.jsx(K,{onClick:R,disabled:p,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:p?"Removendo...":"Sim, excluir"})]})]})})]})}export{Je as CustomerList};
