import{u as E,r as M,j as e,a as i,t as v}from"./app-DQPXqyy6.js";import{P as _}from"./Index-J7DcMISg.js";import{S as I,B as A}from"./status-badge-Cc9q639b.js";import{B as S}from"./button-D5vWEiac.js";import{D as O,a as k,b as z,c as F,e as g,d as f}from"./dropdown-menu-BGF5fV-q.js";import{I as L}from"./input-DyStY0q5.js";import{T as R,a as H,b as h,c as r,d as q,e as t}from"./table-CEcLtHF-.js";import{u as Q,a as V,P as b}from"./useSort-Df7S5d4M.js";import{f as D}from"./index-9YGKT2P1.js";import{T as n}from"./index-CnTLoYi9.js";import{S as G}from"./search-CdWRY7Gz.js";import{E as J}from"./ellipsis-DPA6U6Uv.js";/* empty css            */import"./select-j1y55RD1.js";import"./index-Dc_FVRD7.js";import"./index-BXjLavUZ.js";import"./index-BTFQTnP1.js";import"./createLucideIcon-DTltB1YP.js";import"./index-D3GA1IrA.js";import"./index-CdpUR5B_.js";import"./index-DNtamNmN.js";import"./utils-BkIxhzDH.js";import"./check-1cbie2Cp.js";import"./badge-DqPQ3dnD.js";import"./index-B9BnfCey.js";import"./proxy-hqGVL8UZ.js";function ge({pagination:d,filters:c}){const{data:o,setData:x}=E({search:c.search||"","per-page":c["per-page"]||15}),{handleDebounceFilter:N}=Q({path:n("employee.customer-plans.index"),initialData:o,onDataChange:x}),{handleSort:y,getSortDirection:j}=V({sortBy:c["sort-by"]||"status",sortDirection:c.direction||"asc"}),w=s=>{const a={...o,"per-page":s};x(a),i.get(n("employee.customer-plans.index"),D(a),{preserveState:!0,preserveScroll:!0})},m=s=>{const a=y(s),u={...o,...a};i.get(n("employee.customer-plans.index"),D(u),{preserveState:!0,preserveScroll:!0})},P=d.data.length>0,C=s=>s?new Date(s).toLocaleDateString("pt-BR"):"—",[B,p]=M.useState(null);return e.jsxs("div",{className:"rounded-xl bg-accent px-3 pt-4",children:[e.jsxs("div",{className:"flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-center",children:[e.jsx("h1",{className:"text-lg font-bold",children:"Planos de Clientes"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{leftIcon:e.jsx(G,{className:"size-4"}),name:"search",placeholder:"Buscar clientes...",id:"search",value:o.search,onChange:N,className:"w-full sm:max-w-sm"}),e.jsxs(S,{type:"button",size:"sm",className:"cursor-pointer",onClick:()=>i.visit(n("employee.customer-plans.create")),children:[e.jsx("span",{className:"text-xs",children:"Vincular plano"}),e.jsx(b,{className:"size-4"})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"overflow-hidden",children:e.jsxs(R,{children:[e.jsx(H,{children:e.jsxs(h,{children:[e.jsx(r,{children:"ID"}),e.jsx(r,{sortable:!0,sortBy:"name",sortDirection:j("name"),onSort:m,children:"Cliente"}),e.jsx(r,{children:"Plano"}),e.jsx(r,{sortable:!0,onSort:()=>m("chosen_lockup_days"),children:"Carência escolhida (dias)"}),e.jsx(r,{sortable:!0,sortBy:"status",sortDirection:j("status"),onSort:m,children:"Status"}),e.jsx(r,{sortable:!0,onSort:()=>m("activated_on"),children:"Ativado em"}),e.jsx(r,{children:e.jsx("span",{className:"sr-only",children:"Ações"})})]})}),e.jsx(q,{children:P?d.data.map((s,a)=>{const u=s.status==="pre_active",T=B===s.id;return e.jsxs(h,{className:"hover:!bg-secondary/10",children:[e.jsx(t,{children:a+1}),e.jsx(t,{children:s.customer?.name}),e.jsx(t,{children:s.plan?.name}),e.jsx(t,{children:s.chosen_lockup_days||s.plan?.lockup_days||"—"}),e.jsx(t,{children:e.jsx(I,{status:s.status})}),e.jsx(t,{children:C(s.activated_on)}),e.jsx(t,{className:"text-right",children:e.jsxs(O,{open:T,onOpenChange:l=>p(l?s.id:null),children:[e.jsx(k,{asChild:!0,children:e.jsxs(S,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Abrir menu"}),e.jsx(J,{className:"h-4 w-4"})]})}),e.jsxs(z,{align:"end",children:[e.jsx(F,{children:"Ações"}),e.jsx(g,{}),u&&e.jsxs(f,{onSelect:l=>{l.preventDefault(),p(null),document.activeElement?.blur?.(),i.post(n("employee.customer-plans.activate",{customerPlan:s.id}),{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>v.success("Plano ativado com sucesso!"),onError:()=>v.error("Erro ao ativar plano. Tente novamente.")})},children:[e.jsx(A,{className:"mr-2 h-4 w-4 text-emerald-600"}),"Ativar plano"]}),e.jsxs(f,{onSelect:l=>{l.preventDefault(),p(null),document.activeElement?.blur?.(),i.visit(n("admin.deposits.create",{cp:s.id}))},children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),"Novo aporte"]}),e.jsx(g,{})]})]})})]},String(s.id))}):e.jsx(h,{children:e.jsx(t,{colSpan:7,className:"h-24 text-center text-sm text-muted-foreground",children:"Nenhum plano de cliente encontrado."})})})]})})}),e.jsx(_,{meta:d?.meta,perPage:o["per-page"],setPerPage:w})]})}export{ge as CustomerPlanList};
