import{u as y,r as n,j as e,H as b,L as k,t as u}from"./app-D1QTuDhJ.js";import{C as m}from"./combobox-BRdqbPTh.js";import{B as x}from"./button-CjsFrxyq.js";import{C as N,a as P,b as B,c as E}from"./card-POPs74si.js";import{L as d}from"./label-C8iPZTTK.js";import{A as L}from"./app-layout-CJjyHprM.js";/* empty css            */import"./popover-CrdbZeVi.js";import"./createLucideIcon-DFi8gACE.js";import"./index-2tsdWD63.js";import"./index-DwBoTTRC.js";import"./index-B9yUo-Ai.js";import"./index-DvlxdSxl.js";import"./utils-BkIxhzDH.js";import"./search-CTwqVz6b.js";import"./index-DGw6JHWd.js";import"./index-Dc_FVRD7.js";import"./check-tbf6p6GB.js";import"./input-CHa5w17A.js";import"./index-CzgvQrgu.js";import"./dropdown-menu-CRqzibls.js";function Y({customers:p,plans:l}){const{data:o,setData:i,post:h,processing:_,errors:t}=y({user_id:"",investment_plan_id:"",chosen_lockup_days:""}),[r,j]=n.useState(null),v=n.useMemo(()=>p.map(s=>({value:String(s.id),label:`${s.name} — ${s.email}`,meta:s})),[p]),f=n.useMemo(()=>l.map(s=>({value:String(s.id),label:s.name,meta:s})),[l]),g=n.useMemo(()=>{if(!r)return[];const s=[...r.lockup_options?.map(a=>a.lockup_days)??[],r.lockup_days].filter(a=>typeof a=="number");return Array.from(new Set(s)).sort((a,C)=>a-C).map(a=>({value:String(a),label:`${a}`}))},[r]);n.useEffect(()=>{const s=l.find(c=>String(c.id)===String(o.investment_plan_id))||null;j(s),i("chosen_lockup_days","")},[o.investment_plan_id]);function S(s){s.preventDefault(),h(route("employee.customer-plans.store"),{onSuccess:()=>u.success("Plano vinculado ao cliente com sucesso!"),onError:()=>u.error("Erro ao vincular plano ao cliente. Verifique os campos e tente novamente.")})}return e.jsxs(L,{children:[e.jsx(b,{title:"Vincular Plano"}),e.jsxs(N,{children:[e.jsx(P,{children:e.jsx(B,{className:"text-2xl",children:"Vincular plano a cliente"})}),e.jsx(E,{children:e.jsxs("form",{onSubmit:S,className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(d,{children:"Cliente"}),e.jsx(m,{value:String(o.user_id||""),onChange:s=>i("user_id",s),items:v,placeholder:"Selecione o cliente…",searchPlaceholder:"Buscar cliente…"}),t.user_id&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.user_id})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(d,{children:"Plano"}),e.jsx(m,{value:String(o.investment_plan_id||""),onChange:(s,c)=>i("investment_plan_id",s),items:f,placeholder:"Selecione o plano…",searchPlaceholder:"Buscar plano…"}),t.investment_plan_id&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.investment_plan_id})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(d,{children:"Carência (dias) — opcional"}),e.jsx(m,{value:String(o.chosen_lockup_days||""),onChange:s=>i("chosen_lockup_days",s),items:g,placeholder:r?"Escolha ou deixe em branco p/ padrão":"Selecione um plano primeiro",searchPlaceholder:"Buscar carência…"}),t.chosen_lockup_days&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.chosen_lockup_days}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Deixe vazio para usar a carência padrão do plano."})]}),e.jsxs("div",{className:"flex gap-2 md:col-span-2",children:[e.jsx(k,{href:route("employee.customer-plans.index"),children:e.jsx(x,{variant:"outline",children:"Cancelar"})}),e.jsx(x,{type:"submit",disabled:_,children:"Salvar vínculo"})]})]})})]})]})}export{Y as default};
